---
date: "Last compiled on `r format(Sys.time(), '%d %B, %Y')`"
output:
  word_document:
    toc: TRUE
    toc_depth: 2
  html_document:
    toc: TRUE
    toc_float: TRUE
    toc_depth: 2
    dev: png
    keep_md: yes
  pdf_document:
    toc: TRUE
    toc_depth: 2
    dev: png
    extra_dependencies: ["float", "booktabs"]
    keep_md: no
urlcolor: blue
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(
   warning=FALSE,
   message=FALSE,
   echo=FALSE
)
options(knitr.kable.NA = '-')

```

The file being used for the analysis is: **`r file_short`**

```{r libraries, message=FALSE, echo=FALSE, warning=FALSE, include=FALSE}
library(knitr)
library(data.table)
library(dplyr)
library(lubridate)
library(ggplot2)
library(ggpubr)
library(scales)
library(EnvStats)
library(tidyr)
library(kableExtra)
library(glue)
library(grid)
library(stringr)
options(scipen=999)

```

---
title: '`r paste("SEACAR Coastal Wetlands Analysis:", parameter)`'
---

\newpage
# Coastal Wetlands Species Richness

```{r show_plots, results='asis'}
cw_plots <- list.files("output/Figures", full.names = T, pattern=".png$")
# Get plot function locates filepath
get_plot <- function(ma){
  str_subset(cw_plots, gsub(" ", "", ma))
}
# Make table function shows trend results
make_table <- function(ma){
  ResultTable <- MA_Ov_Stats[ManagedAreaName==ma,]
  # Removes location, species group, and parameter information because it is
  # in plot labels
  ResultTable <- ResultTable[,-c("AreaID", "ManagedAreaName",
                                 "ProgramIDs", "Programs", "ParameterName")]
  # Renames StandardDeviation to StDev to save horizontal space
  ResultTable <- ResultTable %>%
    rename("StDev"="StandardDeviation")
  # Converts all non-integer values to 2 decimal places for space
  ResultTable$Min <- round(ResultTable$Min, 2)
  ResultTable$Max <- round(ResultTable$Max, 2)
  ResultTable$Median <- round(ResultTable$Median, 2)
  ResultTable$Mean <- round(ResultTable$Mean, 2)
  ResultTable$StDev <- round(ResultTable$StDev, 2)
  names(ResultTable) <- gsub("_", "-", names(ResultTable))
  
  result_table <- kable(ResultTable, format="latex",
                        caption=paste0("Coastal Wetlands Species Richness - ", ma),
                        row.names = FALSE, digits = 2,
                        booktabs = T, linesep = "", escape = F, longtable = F) %>%
    kableExtra::kable_styling(latex_options = c("scale_down", "HOLD_position"))
  return(print(result_table))
}


for(ma in cw_MA_Include){
  cat("  \n")
  cat(glue("## {ma}"))
  plot_loc <- get_plot(ma)
  cat("  \n")
  cat("![](", plot_loc,")")
  cat("  \n")
  make_table(ma)
  cat("  \n")
}

```
